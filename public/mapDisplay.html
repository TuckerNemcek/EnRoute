<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">


  <title>EnRoute Emergency Vehicle Tracking System</title>

  <!-- materialize -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <!-- google fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!--font awesome-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">

  <!--local stylesheet-->
  <link rel="stylesheet" href="./stylesheets/style.css">

  <!--google map api-->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDLUP4qTMvYe31IOZoo4WIZEYM0Pysj-Fk&callback=initMap" async defer></script>

  <!--local js files-->
  <script src="./javascripts/index.js"></script>
  <script src="./javascripts/login.js"></script>

</head>

<body>
  <!-- <div class="wrapper"> -->
  <header>
    <!--Materialize Navbar-->
    <nav class="blue-grey darken-4">
      </div>
      <div class="nav-wrapper">
        <span>
          <img class="logo-png" src="/images/119060.svg">
        </span>
        <a href="index.html" class="brand-logo main-font white-text m-l">EnRoute</a>
        <a href="index.html" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">Menu</i></a>

        <ul class="right hide-on-med-and-down">
          <li><a class="grey-text text-darken-5" href="mapDisplay.html">Map</a></li>
          <li><a class="grey-text text-darken-5" href="messages.html">Messages</a></li>
          <li><a class="grey-text text-darken-5" href="account.html">Account</a></li>
        </ul>

      </div>
    </nav>

    <!--Materialize Mobile Nav-->
    <ul class="sidenav" id="mobile-demo">
      <li><a href="mapDisplay.html">Map</a></li>
      <li><a href="messages.html">Messages</a></li>
      <li><a href="account.html">Account</a></li>
    </ul>

  </header>
  <div id="map" class="map">
    <main class='container'>

      <script>
        let myLatLng
        let emer


        function initMap() {
          let directionsService = new google.maps.DirectionsService();
          let directionsDisplay = new google.maps.DirectionsRenderer();
          let chicago = new google.maps.LatLng(41.850033, -87.6500523);

          //// BEGIN INFO FOR ICONS
          function addFire(coords) {
            let marker = new google.maps.Marker({
              position: coords,
              map: map,
              icon: fireIcon
            })
          }

          function addAmb(coords) {
            let marker = new google.maps.Marker({
              position: coords,
              map: map,
              icon: ambIcon
            })
          }
          let fireIcon = {
            url: "https://cdn.emojidex.com/emoji/seal/fire.png?1466441570", // url
            scaledSize: new google.maps.Size(25, 25), // scaled size
            origin: new google.maps.Point(0, 0), //
            anchor: new google.maps.Point(0, 0) //
          }

          let ambIcon = {
            url: "https://images.emojiterra.com/google/android-pie/512px/1f691.png", // url
            scaledSize: new google.maps.Size(25, 25),
            origin: new google.maps.Point(0, 0), //
            anchor: new google.maps.Point(0, 0) //
          }
          ////END INFO FOR ICONS


          // ToDo Center the map on something more sensible, this is a placeholder
          let options = {
            zoom: 15,
            center: {
              lat: 40.0150,
              lng: -105.2705,
              mapTypeId: google.maps.MapTypeId.ROADMAP

            }
          }
          let map = new google.maps.Map(document.getElementById('map'), options);
          directionsDisplay.setMap(map);

          function geo_success(position) {
            myLatLng = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            }
            emer = {
              lat: 40.019500,
              lng: -105.280622
            }

            addAmb(myLatLng)
            addFire(emer)
            let start = myLatLng
            let end = emer
            let request = {
              origin: myLatLng,
              destination: end,
              travelMode: 'DRIVING',
            }
            directionsService.route(request, function(result, status) {
              if (status == 'OK') {
                directionsDisplay.setDirections(result);
              }
            })

          }

          function geo_error() {
            alert("Sorry, no position available.");
          }

          let geo_options = {
            enableHighAccuracy: true,
            maximumAge: 30000,
            timeout: 27000
          };

          let wpid = navigator.geolocation.watchPosition(geo_success, geo_error, geo_options);
        }
      </script>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDLUP4qTMvYe31IOZoo4WIZEYM0Pysj-Fk&callback=initMap" async defer>
      </script>
    </main>
    <!-- Footer -->
    <!-- Map Marker Icon -->
    <footer class="page-footer blue-grey darken-4">
      <div class="footer-menu-item">
        <span style="font-size: 48px; color: white;">
          <a href="mapDisplay.html"><i class="fas fa-map-marker-alt fa-xs"></i></a>
        </span>
      </div>
      <!-- Ambulance Icon -->
      <div class="footer-menu-item">
        <span style="font-size: 48px; color: #e64525;">
          <a href="messages.html"><i class="fa fa-ambulance fa-xs"></i></a>
        </span>
      </div>
      <!-- Settings/Account Icon -->
      <div class="footer-menu-item">
        <span style="font-size: 48px; color: #9e9e9e;">
          <a href="account.html"><i class="fas fa-cog fa-xs"></i></a>
        </span>
      </div>
    </footer>
    </div>
  <script src="./javascripts/map.js"></script>
</body>

</html>
